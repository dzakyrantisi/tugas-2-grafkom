<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>Sepeda</title>
  <style>
    body { font-family: Arial, sans-serif; display:flex; flex-direction:row; align-items:flex-start; justify-content:center; gap:12px; background:#ececec; padding:12px; }
    #gl-canvas { margin:0; border:1px solid #bbb; background:#222; }
    /* narrower controls to avoid scrolling */
    .controls { width:360px; max-height:92vh; overflow:auto; background:#fff; padding:8px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.08); font-size:13px; }
    .row { display:flex; gap:8px; align-items:center; margin:6px 0; }
    .section { margin: 10px 0; padding: 8px; background: #f9f9f9; }
    .section h4 { margin: 0 0 8px 0; color: #333; font-size:14px }
    label { width:95px; font-size:13px }
    input[type="range"] { flex:1; }
    button { padding:6px 8px; font-size:13px }
    .reference-photo { display:flex; flex-direction:column; align-items:center; gap:6px; margin-top:12px; }
    .reference-photo img { max-width:320px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.12); }
  </style>
</head>
<body>

<canvas id="gl-canvas" width="640" height="640"></canvas>

<div class="controls">
  <h3>Kontrol Sepeda 3D</h3>
  
  <div class="section">
  <div class="section">
    <h4>Cahaya</h4>
    <div class="row">
      <label>Ambient</label>
      <input id="ambientColor" type="color" value="#4d4d4d" />
    </div>
    <div class="row">
      <label>Diffuse</label>
      <input id="diffuseColor" type="color" value="#b3b3b3" />
    </div>
    <div class="row">
      <label>Specular</label>
      <input id="specularColor" type="color" value="#ffffff" />
    </div>
    <div class="row">
      <label>Posisi Cahaya X</label>
      <input id="lightX" type="range" min="-10" max="10" step="0.1" value="2" />
    </div>
    <div class="row">
      <label>Posisi Cahaya Y</label>
      <input id="lightY" type="range" min="-10" max="10" step="0.1" value="2" />
    </div>
    <div class="row">
      <label>Posisi Cahaya Z</label>
      <input id="lightZ" type="range" min="-10" max="10" step="0.1" value="2" />
    </div>
  </div>
  </div>

  <div class="section">
    <h4>Rotasi</h4>
    <div class="row">
      <label>Rotasi X</label>
      <input id="rotateX" type="range" min="0" max="360" value="0" />
    </div>
    <div class="row">
      <label>Rotasi Y</label>
      <input id="rotateY" type="range" min="0" max="360" value="0" />
    </div>
    <div class="row">
      <label>Rotasi Z</label>
      <input id="rotateZ" type="range" min="0" max="360" value="0" />
    </div>
  </div>

  <div class="section">
    <h4>Posisi</h4>
    <div class="row">
      <label>Geser X</label>
      <input id="transX" type="range" min="-2" max="2" step="0.01" value="0" />
    </div>
    <div class="row">
      <label>Geser Y</label>
      <input id="transY" type="range" min="-2" max="2" step="0.01" value="0" />
    </div>
    <div class="row">
      <label>Geser Z</label>
      <input id="transZ" type="range" min="-8" max="-1" step="0.01" value="-4" />
    </div>
  </div>

  <div class="section">
    <h4>Skala</h4>
    <div class="row">
      <label>Skala</label>
      <input id="scale" type="range" min="0.4" max="2.5" step="0.01" value="1" />
    </div>
  </div>

  <div class="section">
    <h4>Kamera</h4>
    <div class="row">
      <label>Kamera X</label>
      <input id="camX" type="range" min="-10" max="10" step="0.1" value="0" />
    </div>
    <div class="row">
      <label>Kamera Y</label>
      <input id="camY" type="range" min="-10" max="10" step="0.1" value="0" />
    </div>
    <div class="row">
      <label>Kamera Z</label>
      <input id="camZ" type="range" min="1" max="15" step="0.1" value="5" />
    </div>
  </div>

  <!-- Projection controls removed to simplify UI -->

  <div style="margin-top:12px; text-align: center;">
    <button id="resetBtn">Reset</button>
  </div>
  <div class="section" style="margin-top:12px;">
    <h4>Kontrol Sepeda</h4>
    <div class="row">
      <label>Kecepatan Pedal</label>
      <input id="pedalSpeed" type="range" min="-5" max="10" step="0.1" value="0" />
    </div>
    <div class="row">
      <label>Steer / Stir</label>
      <input id="steer" type="range" min="-45" max="45" step="1" value="0" />
    </div>
    <div class="row">
      <label>Animasi ON</label>
      <input id="animateToggle" type="checkbox" />
    </div>
  </div>
</div>

<div class="reference-photo">
  <strong>Referensi Sepeda</strong>
  <img src="foto_sepeda.jpg" alt="Foto referensi sepeda" />
  <strong>gambar tree</strong>
  <img src="foto_tree_hierarichal.jpg" alt="Foto referensi sepeda" />
  <div style="font-size:13px; margin-top:6px; text-align:left;">
    <strong>Hierarki Sepeda</strong>
    <div>Parent: Body Sepeda</div>
    <div style="margin-left:14px;">Child: Stang (sib: Roda Belakang, Pedal)</div>
    <div style="margin-left:14px;">Child: Roda Belakang (sib: Stang, Pedal)</div>
    <div style="margin-left:14px;">Child: Pedal (sib: Stang, Roda Belakang)</div>
    <div style="margin-left:28px;">Stang â†’ Child: Roda Depan</div>
  </div>

</div>

<!-- Vertex shader -->
<script id="vertex-shader" type="x-shader/x-vertex">
attribute vec4 vPosition;
attribute vec4 vColor;
attribute vec2 vTexCoord;
varying vec4 vColorInterp;
varying vec3 vNormal;
varying vec3 vPositionWorld;
varying vec2 vTexCoordV;

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vPosition;
  vColorInterp = vColor;
  vTexCoordV = vTexCoord;
  vPositionWorld = vec3(modelViewMatrix * vPosition);
  // Normal sederhana: asumsikan normal ke depan (Z+)
  vNormal = normalize(mat3(modelViewMatrix) * vec3(0.0, 0.0, 1.0));
}
</script>

<!-- Fragment shader -->
<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;
varying vec4 vColorInterp;
varying vec3 vNormal;
varying vec3 vPositionWorld;
varying vec2 vTexCoordV;

uniform vec3 ambientColor;
uniform vec3 diffuseColor;
uniform vec3 specularColor;
uniform vec3 lightPos;
uniform sampler2D uSampler;
uniform bool useTexture;

void main() {
  vec3 N = normalize(vNormal);
  vec3 L = normalize(lightPos - vPositionWorld);
  float diff = max(dot(N, L), 0.0);

  // View direction
  vec3 V = normalize(-vPositionWorld);
  // Reflect direction
  vec3 R = reflect(-L, N);
  float spec = pow(max(dot(R, V), 0.0), 100.0);

  vec3 ambient = ambientColor * vColorInterp.rgb;
  vec3 diffuse = diffuseColor * vColorInterp.rgb * diff;
  vec3 specular = specularColor * spec;

  vec3 color = ambient + diffuse + specular;
  if(useTexture) {
    vec4 t = texture2D(uSampler, vTexCoordV);
    gl_FragColor = vec4(color * t.rgb, vColorInterp.a * t.a);
  } else {
    gl_FragColor = vec4(color, vColorInterp.a);
  }
}
</script>

<!-- library files: jangan ubah MVnew.js & initShaders.js -->
<script src="MVnew.js"></script>
<script src="initShaders.js"></script>
<!-- clock/time controls removed for bike UI -->
<script src="main.js"></script>

</body>
</html>